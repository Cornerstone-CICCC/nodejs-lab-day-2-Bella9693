---
---
<html>
  <head>
    <meta charset="utf-8" />
    <title>Profile</title>
  </head>
  <body>
    <h1>Profile</h1>
    <div id="profile">Loading...</div>
    <button id="logoutBtn">Logout</button>

    <script is:inline>
      async function loadProfile() {
        const res = await fetch("http://localhost:3500/users/check-auth", {
          method: "GET",
          credentials: "include",
        });

        if (!res.ok) {
          window.location.href = "/login";
          return;
        }

        const data = await res.json();
        const el = document.getElementById("profile");
        el.innerHTML = `
          <p><strong>Username:</strong> ${data.username}</p>
          <p><strong>First name:</strong> ${data.firstname}</p>
          <p><strong>Last name:</strong> ${data.lastname}</p>
        `;
      }

      document
        .getElementById("logoutBtn")
        .addEventListener("click", async () => {
          await fetch("http://localhost:3500/users/logout", {
            method: "GET",
            credentials: "include",
          });
          window.location.href = "/login";
        });

      loadProfile();
    </script>
  </body>
</html>
